mwf.touch.geolocation=new function(a){var i={GENERAL:"Geolocation failure.",NO_SUPPORT:"No geolocation support available.",PERMISSION_DENIED:"Geolocation permission not granted."};var c={NO_SUPPORT:{code:2,message:i.NO_SUPPORT,PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3}};var f=-1;var d=null;var h=true;var g=3000;var b=5000;var e=typeof a=="undefined"?undefined:a;this.getType=function(){if(f<0){f=typeof e!="undefined"?3:navigator.geolocation?1:typeof google!="undefined"&&google.gears?2:0}return f};this.getTypeName=function(){switch(this.getType()){case 1:return"HTML5 Geolocation";case 2:return"Google Gears";case 3:return"Custom";default:return"Unsupported"}};this.getApi=function(){if(typeof e=="undefined"){switch(this.getType()){case 1:e=navigator.geolocation;break;case 2:e=google.gears.factory.create("beta.geolocation");break;default:e=null}}return e};this.isSupported=function(){return this.getType()>0};this.getPosition=function(l,j){var k=this.getApi();if(k===null){if(typeof j!="undefined"){j(i.NO_SUPPORT)}return}k.getCurrentPosition(function(m){if(typeof l!="undefined"){l({latitude:m.coords.latitude,longitude:m.coords.longitude,accuracy:m.coords.accuracy})}},function(m){if(typeof j!="undefined"){var n=m.code==m.PERMISSION_DENIED?i.PERMISSION_DENIED:i.GENERAL;j(n)}},{enableHighAccuracy:h,maximumAge:g,timeout:b});return};this.getCurrentPosition=function(l,j){var k=this.getApi();if(k===null){if(typeof j=="function"){j(c.NO_SUPPORT)}return}k.getCurrentPosition(function(m){if(typeof l=="function"){l({latitude:m.coords.latitude,longitude:m.coords.longitude,accuracy:m.coords.accuracy})}},function(m){if(typeof j=="function"){j(m)}},{enableHighAccuracy:h,maximumAge:g,timeout:b});return};this.watchPosition=function(m,k){var l=this.getApi();if(!l){if(typeof k=="function"){k(c.NO_SUPPORT)}return}var j=l.watchPosition(function(n){m&&m({latitude:n.coords.latitude,longitude:n.coords.latitude,accuracy:n.coords.accuracy})},function(n){if(typeof k=="function"){k(n)}},{enableHighAccuracy:h,maximumAge:g,timeout:b});return j};this.clearWatch=function(j){var k=this.getApi();if(k!==null){k.clearWatch(j)}};this.setTimeout=function(j){g=j};this.setHighAccuracy=function(j){h=j}};